<div class="ubcpi_block problem">

    <div class="revise" data-ng-controller="ReviseController as rc">

        <div class="question-other-explain" data-ng-if="rc.status() == rc.STATUS_NEW || rc.status() == rc.STATUS_ANSWERED">

            <h2 class="question-text">Question: {{question_text}}</h2>

            <div class="others-responses" data-ng-if="rc.status() == rc.STATUS_ANSWERED">

                <h3>Others' responses</h3>
                <p>Here is a selection of other students' answers. They may help you refine your answer.</p>

                <ul class="ubcpi-other-answers">
                    <li data-ng-repeat="answer in rc.other_answers.answers">
                        <h4 class="other-answer">Answer:
                            <span ng-switch="options[answer.option].type">
                                <img ng-switch-when="image" alt="image" ng-src="{{options[answer.option].name}}" />
                                <span ng-switch-default>{{options[answer.option].name}}</span>
                            </span>
                        </h4>
                        <p class="other-rationale">{{answer.rationale}}</p>
                    </li>
                </ul>

                <p>If you wish, you may now revise your answer.</p>

            </div><!-- .others-responses -->

            <form class="choicegroup your-answer-and-rationale">
                <h3>Your Response</h3>
                <fieldset role="radiogroup" aria-label>
                    <label class="ubcpi-label ubcpi-answer" data-ng-repeat="option in options track by $index">
                        <input class="ubcpi-field" type="radio"  name="q" data-ng-model="rc.answer" value="{{$index}}" integer>
                        <span ng-switch="option.type">
                            <img ng-switch-when="image" alt="image" ng-src="{{option.name}}" />
                            <span ng-switch-default>{{option.name}}</span>
                        </span>
                    </label>
                </fieldset>

                <label class="ubcpi-label" for="{{appId}}_rationale">Please explain your selection:</label>
                <textarea class="ubcpi-field ubcpi-rationale" id="{{appId}}_rationale" name="rationale" data-ng-model="rc.rationale"></textarea>

                <input data-ng-disabled="rc.disableSubmit()" type='button' class='ubcpi_submit' value='Next Step' data-ng-click="rc.clickSubmit($event)" />

            </form>

        </div><!-- .question-other-explain -->

        <div class="correct-revised-chart" data-ng-if="rc.status() == rc.STATUS_REVISED" data-ng-init="rc.getStats()">

            <section class="solution-span correct-answer-and-rationale">

                <span>
                    <div class="detailed-solution">
                        <h2>Correct Answer:
                            <span ng-switch="options[rc.correct_answer].type">
                                <img ng-switch-when="image" alt="image" ng-src="{{options[rc.correct_answer].name}}" />
                                <span ng-switch-default>{{options[rc.correct_answer].name}}</span>
                            </span>
                        </h2>
                        <div>{{rc.correct_rationale}}</div>
                    </div><!-- .detailed-solution -->
                </span>

            </section><!-- .correct-answer-and-rationale -->

            <div class="original-answers results-container choicegroup">
                <h3>Original Answers</h3>
                <fieldset role="radiogroup" aria-label>
                    <label class="ubcpi-label ubcpi-answer" data-ng-repeat="d in chartDataOriginal[0]['values'] track by $index">
                        <input class="ubcpi-field" type="radio" data-ng-model="rc.answer_original" value="{{$index}}" disabled>
                        <span ng-switch="d[0].type">
                            <img ng-switch-when="image" alt="image" ng-src="{{d[0].name}}" />
                            <span ng-switch-default>{{d[0].name}} </span>
                        </span>
                        - {{d[1]}}
                    </label>
                </fieldset>

                <div id="original-bar-chart"></div>

            </div><!-- .original-answers -->

            <div class="revised-answers results-container choicegroup">

                <h3>Revised Answers</h3>
                <fieldset role="radiogroup" aria-label>
                    <label class="ubcpi-label ubcpi-answer" data-ng-repeat="d in chartDataRevised[0]['values'] track by $index">
                        <input class="ubcpi-field" type="radio" data-ng-model="rc.answer_revised" value="{{$index}}" disabled>
                        <span ng-switch="d[0].type">
                            <img ng-switch-when="image" alt="image" ng-src="{{d[0].name}}" />
                            <span ng-switch-default>{{d[0].name}} </span>
                        </span>
                        - {{d[1]}}
                    </label>
                </fieldset>

                <div id="revised-bar-chart"></div>

            </div><!-- .revised-answers -->

        </div><!-- .correct-revised-chart -->

    </div><!-- .revise -->

</div><!-- .ubcpi_block -->
